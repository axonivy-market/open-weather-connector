<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:ic="http://ivyteam.ch/jsf/component"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">
<h:body>
	<ui:composition template="/layouts/frame-10.xhtml">
		<ui:define name="title">ForecastWeather</ui:define>
		<ui:define name="content">
			<h1>Find Weather Forecasts in Any City</h1>
			<p:spacer height="20" />
			<h:form id="form">
				<p:remoteCommand name="rc" update="forecastPanel"
					action="#{forecastWeatherBean.setSelectedTimeByIndex}" />

				<p:messages />
				<p:panelGrid columns="4" layout="grid"
					styleClass="ui-panelgrid-blank ui-fluid"
					columnClasses="ui-g-4, ui-g-3, ui-g-3, ui-g-2"
					style="background-color: #f5fdff; border-radius: 5px">

					<h:panelGroup styleClass="ui-float-label">
						<p:inputText value="#{forecastWeatherBean.searchCityName}" />
						<p:outputLabel for="@previous" value="City name" />
					</h:panelGroup>

					<h:panelGroup styleClass="ui-float-label">
						<p:inputText value="#{forecastWeatherBean.searchCountryCode}" />
						<p:outputLabel for="@previous" value="Country code" />
					</h:panelGroup>

					<h:panelGroup styleClass="ui-float-label">
						<p:inputText value="#{forecastWeatherBean.searchStateCode}" />
						<p:outputLabel for="@previous" value="State code" />
					</h:panelGroup>

					<p:commandButton value="Search" icon="pi pi-search" update="form"
						actionListener="#{forecastWeatherBean.search}" />
				</p:panelGrid>

				<p:spacer height="20" />

				<p:spacer height="20" />

				<div style="display: flex; justify-content: center;">
					<div class="ui-g" style="width: 100%;">
						<p:outputPanel styleClass="ui-g-3 ui-g-nopad weather-container"
							id="forecastPanel"
							style="background-color: #f5fdff; text-align: center; display: flex; justify-content: space-between; flex-direction: column; height: 100%;">
							<div>
								<div class="date-time caption">
									<span class="city"><i class="pi pi-map-marker"
										style="font-size: 16px" /> #{forecastWeatherBean.cityName}</span> <span
										class="time">#{forecastWeatherBean.formattedTime12Hour}</span>
								</div>
								<p:graphicImage class="caption"
									value="https://openweathermap.org/img/wn/#{forecastWeatherBean.currentWeatherIcon}@2x.png"
									width="160px" />
								<div class="caption"
									style="margin-bottom: 5px; line-height: 1; position: relative;">
									<span class="degree">
										#{forecastWeatherBean.currentWeatherDegree} </span>
									<span
										class="temperature-unit">
										<span
											style="position: absolute; top: 6px; right: 30px; font-size: 20px; cursor: pointer;">
											<span
											class="#{forecastWeatherBean.typeOfDegree == 'CELSIUS' ? 'type-of-degree-selected' : ''}">
												째C</span> | <span
											class="#{forecastWeatherBean.typeOfDegree == 'FAHRENHEIT' ? 'type-of-degree-selected' : ''}">째F</span>
										</span>
									</span>
								</div>
								<div class="additional-info caption"
									style="margin-bottom: 40px;">
									<span style="font-size: 14px;">#{forecastWeatherBean.currentWeatherDetail}</span>
								</div>
								<div class="caption"
									style="display: flex; justify-content: space-evenly; font-size: 16px;">
									<div>
										<div style="margin-bottom: 5px; font-size: 14px;">Humidity</div>
										<div style="font-weight: bold; font-size: 18px;">#{forecastWeatherBean.currentHumidity}%</div>
									</div>
									<div>
										<div style="margin-bottom: 5px; font-size: 14px;">Wind
											speed</div>
										<div style="font-weight: bold; font-size: 18px;">#{forecastWeatherBean.currentWindSpeed}mph</div>
									</div>
								</div>
							</div>

							<div class="caption"
								style="padding-bottom: 12px; font-size: 14px;">#{forecastWeatherBean.formattedDate}</div>
						</p:outputPanel>

						<div class="ui-g-9 ui-g-nopad">
							<div class="ui-g-12 ui-g-nopad">
								<p:tabView>
									<p:tab title="Temparature" style="padding: 0">
										<p:lineChart widgetVar="lineChartWidgetVar"
											model="#{forecastWeatherBean.lineModel}"
											style="cursor: pointer; width: 20px; height: 5px;" />
									</p:tab>
									<p:tab title="Precipitation">
									</p:tab>
									<p:tab title="Wind">
									</p:tab>
								</p:tabView>
							</div>
							<div class="ui-g-12 ui-g-nopad"
								style="text-align: center; margin-top: 20px">

								<p:outputPanel id="forecastPanel1"
									style="display: flex; justify-content: space-around; text-align: center;">

									<ui:repeat value="#{forecastWeatherBean.dailyForecasts}"
										var="forecast" varStatus="status">
										<h:commandLink
											class="clickable-item #{status.index == forecastWeatherBean.dateIndex ? 'selected' : ''}"
											action="#{forecastWeatherBean.setSelectedDate(forecast.date)}">
											<p:ajax update=":form:forecastPanel :form:forecastPanel1"
												oncomplete="panChart(#{(status.index - forecastWeatherBean.dateIndex) * 8 - (status.index == forecastWeatherBean.dateIndex ? 0 : 1) * (8 - forecastWeatherBean.dailyForecasts[forecastWeatherBean.dateIndex].sizeDaily)})" />
											<div style="margin-bottom: 10px;">
												<span style="font-size: 20px; font-weight: bold">#{status.first
													? 'Today' : forecast.formattedEEE}</span>
											</div>
											<div style="margin-bottom: 10px;">
												<p:graphicImage
													value="https://openweathermap.org/img/wn/#{forecast.weatherIcon}@2x.png"
													width="100px" />
											</div>

											<div>
												<span
													style="font-size: 14px; margin-right: 5px; font-weight: bold;">#{forecast.maxTemperature}째</span>
												<span style="font-size: 14px;">#{forecast.minTemperature}째</span>
											</div>
										</h:commandLink>
									</ui:repeat>
								</p:outputPanel>
							</div>

						</div>
					</div>
				</div>

				<p:spacer height="100" />
				<div class="command-btns">
					<p:commandLink id="cancel"
						actionListener="#{ivyWorkflowView.cancel()}" process="@this"
						value="Cancel" />
					<p:commandButton id="proceed" actionListener="#{logic.close}"
						value="Proceed" update="form" icon="pi pi-check" />
				</div>

				<h:outputScript library="js" name="temperature-chart.js" />
				<h:outputScript library="chartjs-plugin"
					name="chartjs-plugin-datalabels.min.js" />
			</h:form>
		</ui:define>

	</ui:composition>
</h:body>

</html>